<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-10-03" />

<title></title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore"><center>
Geocoding with Google API
</center></h1>
<h3 class="subtitle"><em><center>
<a href="mailto:farch587@student.liu.se">farch587@student.liu.se</a>, <a href="mailto:syesh076@student.liu.se">syesh076@student.liu.se</a>
</center></em></h3>
<h4 class="author"><em><center>
Farhana Chowdhury Tondra, Syeda Farha Shazmeen
</center></em></h4>
<h4 class="date"><em>2017-10-03</em></h4>



<p><strong>RCourseLab5</strong> is entitled for the students who took the Advanced R course. This lab is based on API connetivity and Shiny Application creation. The package <strong>Geocode</strong> contains one function <strong>geocode_api</strong> and one shiny package based on that function and a testcase including <strong>vignette</strong> manual. The package is using Google’s geocode API for fetching the latitude, longitude and complete address of user’s desired location.</p>
<p>As usual to the other packages there is a .R script for the API calling inside the <strong>/R</strong> folder, a scripted testcase for testing in <strong>/test/testthat</strong> folder, all .Rd files inside <strong>/man</strong> folder and .Rmd file inside the <strong>/vignettes</strong> folder.</p>
<div id="api.r" class="section level2">
<h2>API.R</h2>
<p>geocode_api() function takes two arguments to call the API but the user is sending only the address argument as “u_address”. Another paramter is <strong>return.call=“json”</strong> which will append with the URL. Two library functions <strong>httr</strong> and <strong>jsonlite</strong> is loaded. User can send any number of locations.</p>
<p><strong>dm</strong> A matrix for containing the parsed data.</p>
<p><strong>dk</strong> A dataframe for returning the location, latitude , longitude &amp; fulladdress.</p>
<p><strong>root</strong> The fixed url for Google’s geocode API HTTP request.</p>
<p><strong>url</strong> Creating a full URL for calling API using the return.call, address &amp; key parameters.</p>
<p><strong>key</strong> Key is for authenticating the Google Maps Geocoding API which can be added in the app.</p>
<p><strong>resp</strong> The GET method from <em>httr</em> package retrieves the desired information using the url.</p>
<p><strong>parsed</strong> parsed is using the method <em>jsonlite::fromJSON</em> function to convert JSON data (google’s response) in R objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (httr<span class="op">::</span><span class="kw">http_type</span>(resp) <span class="op">!=</span><span class="st"> &quot;application/json&quot;</span>) {
      <span class="kw">stop</span>(<span class="st">&quot;API didn't return json&quot;</span>, <span class="dt">call. =</span> <span class="ot">FALSE</span>)
    }</code></pre></div>
<p>This above mentioned chunk is used to check the JSON response from geocode API.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="cf">if</span> (httr<span class="op">::</span><span class="kw">http_error</span>(resp)) {
      <span class="kw">stop</span>(
        <span class="kw">sprintf</span>(
          <span class="st">&quot;Github API request failed [%s]</span><span class="ch">\n</span><span class="st">%s</span><span class="ch">\n</span><span class="st">%s&quot;</span>,
          httr<span class="op">::</span><span class="kw">status_code</span>(resp),
          parsed<span class="op">$</span>message,
          parsed<span class="op">$</span>documentation_url
        ),
        <span class="dt">call. =</span> <span class="ot">FALSE</span>
      )
    }</code></pre></div>
<p>The above mentioned chunk is used to check the response status of geocode API.</p>
<p>Below chunk is self explanatory where the latlong is retriving the latitude and longitude of the location as an array.The fulladd is retriving the complete address of the location. the matrix dm[i,] is taking the column values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  latlong &lt;-<span class="st"> </span><span class="kw">as.array</span>(parsed<span class="op">$</span>results[[<span class="dv">1</span>]]<span class="op">$</span>geometry<span class="op">$</span>location)
     fulladd &lt;-<span class="st"> </span><span class="kw">as.character</span>(parsed<span class="op">$</span>results[[<span class="dv">1</span>]]<span class="op">$</span>formatted_address)</code></pre></div>
<p>Finally the output is displaying as</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">     <span class="kw">cat</span>(<span class="st">&quot;The full address of &quot;</span>, u_address[i], <span class="st">&quot;is&quot;</span>, fulladd, <span class="st">&quot;.&quot;</span>)
     <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">The latitude of&quot;</span>,u_address[i],<span class="st">&quot;is&quot;</span>,latlong[[<span class="dv">1</span>]],
         <span class="st">&quot;and longitude is &quot;</span>,latlong[[<span class="dv">2</span>]],<span class="st">&quot;.</span><span class="ch">\n\n</span><span class="st">&quot;</span>)</code></pre></div>
</div>
<div id="test_geocode.r" class="section level2">
<h2>test_geocode.R</h2>
<p>Testcase file contains 2 testcases for checking the functionality of the package.</p>
<div id="function-is-not-wrong" class="section level3">
<h3>1. Function is not wrong :</h3>
<p>If user gives the input without double quotation &quot; &quot; , then the function will throw an error.</p>
</div>
<div id="return-method-result" class="section level3">
<h3>4. Return method result:</h3>
<p>Result contains the location,latitude , longitude and full address of the desired place.</p>
</div>
</div>
<div id="documentation-using-roxygen" class="section level2">
<h2>Documentation using Roxygen:</h2>
<p>Package contains a .R file for package documentation named as Geocode.R. The roxygen skeleton made the documentation of API.R. So inside /man folder there are three files named as Geocode.Rd , geocode_api.Rd and Geocode-package.Rd.</p>
<div id="namespace" class="section level3">
<h3>NAMESPACE:</h3>
<p>This file is unmodified.</p>
</div>
<div id="description" class="section level3">
<h3>DESCRIPTION:</h3>
<p>This file is modified as per user details. Due to build and check issues library packages needed to run the package is added as <em>Suggests</em>.</p>
</div>
</div>
<div id="shiny-package" class="section level2">
<h2>Shiny package</h2>
<p>Shiny package is a wrap up of the original API connecting function but with a visualization effect. The shiny app is writted in a single file where the ui and server both funtions are written. The package is created under the <em>Geocode/Geocode/</em> folder.</p>
<div id="ui-function" class="section level3">
<h3>ui function</h3>
<p>UI has three panels where one is headerpanel which is the title bar for the app. Second one is sidebarLayout which contains the input data field which is a text input. And the main panel is representing the output which will be coming from the server. The function <strong>textInput</strong>,<strong>tableOutput</strong>,<strong>textOutput</strong> is used for taking the location input from the user and rest of them is returning data.</p>
</div>
<div id="server-function" class="section level3">
<h3>server function</h3>
<p>Server function is taking two parameters one is input and another is output. The <strong>renderTable</strong> is represeting the data as a datatable for better visualization of data.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples:</h2>
<p>geocode_api(“linkoping”) geocode_api(“boston”)</p>
</div>
<div id="output" class="section level2">
<h2>Output:</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">The full address of  stockholm is Stockholm, Sweden .
The latitude of stockholm is <span class="fl">59.32932</span> and longitude is  <span class="fl">18.06858</span> .</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  Location   Latitude  Longitude       FullAdrress
  <span class="dv">1</span> linkoping <span class="fl">58.4531271</span> <span class="fl">15.7461581</span> Linköping, Sweden</code></pre></div>
<p>This package can be installed using below command</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;tondralok/GoogleAPI/Geocode&quot;</span>)</code></pre></div>
<p>To get the geocode data , run</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">geocode_api</span>(location)</code></pre></div>
<p>To download the ShinyApp run the command</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">shiny<span class="op">::</span><span class="kw">runGitHub</span>(<span class="st">&quot;GoogleAPI&quot;</span>, <span class="dt">username=</span><span class="st">&quot;tondralok&quot;</span>, <span class="dt">ref=</span><span class="st">&quot;master&quot;</span>,<span class="dt">subdir =</span><span class="st">&quot;Geocode/ShinyApp&quot;</span>)</code></pre></div>
</div>
<div id="references" class="section level2">
<h2>References:</h2>
<p>The study material for this lab given below.</p>
<p><a href="https://github.com/tondralok/GoogleAPI/tree/master/Geocode" class="uri">https://github.com/tondralok/GoogleAPI/tree/master/Geocode</a> <a href="https://developers.google.com/maps/documentation/geocoding/start" class="uri">https://developers.google.com/maps/documentation/geocoding/start</a></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
